<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
    <title>Urban Farming Solutions - World Hunger Relief</title>
    <style>
        /* Makes sure nothing has extra space by default */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f9f9f9;
        }

        /* Green header at the top of the page */
        header {
            background-color: #2c7744;
            color: white;
            padding: 1rem;
            text-align: center;
        }

        /* Navigation menu styling */
        nav {
            background-color: #1c5e30;
            padding: 0.5rem;
        }

            nav ul {
                display: flex;
                justify-content: center;
                list-style: none;
            }

                nav ul li {
                    margin: 0 1rem;
                }

                    nav ul li a {
                        color: white;
                        text-decoration: none;
                        font-weight: bold;
                    }

        /* Main content area - centers everything */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Big welcome section */
        .hero {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background-color: #e8f5e9;
            border-radius: 5px;
        }

            .hero h2 {
                margin-bottom: 1rem;
                color: #2c7744;
            }

        /* Makes cards arrange in a grid */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* Individual feature boxes */
        .feature-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

            .feature-card h3 {
                color: #2c7744;
                margin-bottom: 1rem;
            }

        /* Different colored sections */
        .climate-section {
            background-color: #e8f5e9;
            padding: 2rem;
            border-radius: 5px;
            margin-bottom: 2rem;
        }

        .resource-section {
            background-color: #e3f2fd;
            padding: 2rem;
            border-radius: 5px;
            margin-bottom: 2rem;
        }

        .growing-section {
            background-color: #f1f8e9;
            padding: 2rem;
            border-radius: 5px;
            margin-bottom: 2rem;
        }

        /* Grid for category cards (vegetables, fruits, herbs) */
        .category-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        /* Makes cards clickable and adds hover effect */
        .category-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

            /* Card lifts up when you hover over it */
            .category-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            }

        /* Image area for category cards */
        .category-image {
            height: 200px;
            background-color: #f0f0f0;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .image-placeholder {
            color: #999;
            font-size: 14px;
            text-align: center;
        }

        .category-content {
            padding: 1.5rem;
        }

            .category-content h3 {
                color: #2c7744;
                margin-bottom: 0.5rem;
            }

        /* Grid for individual crop items */
        .crop-grid {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .crop-item {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

            .crop-item:hover {
                transform: translateY(-3px);
            }

            /* Small image box for each crop */
            .crop-item .crop-image {
                width: 80px;
                height: 80px;
                background-color: #f0f0f0;
                border-radius: 8px;
                margin: 0 auto 0.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 1px solid #e0e0e0;
                overflow: hidden;
            }

                .crop-item .crop-image img {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }

            .crop-item h4 {
                color: #2c7744;
                margin-bottom: 0.25rem;
            }

            .crop-item p {
                font-size: 0.9rem;
                color: #666;
            }

        /* Green button to go back */
        .back-btn {
            background-color: #2c7744;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 1rem;
            font-weight: bold;
        }

            .back-btn:hover {
                background-color: #1c5e30;
            }

        /* General button style */
        .btn {
            display: inline-block;
            background-color: #2c7744;
            color: white;
            padding: 8px 16px;
            margin-top: 1rem;
            border: none;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

            .btn:hover {
                background-color: #1c5e30;
            }

        /* Login/logout area in top right */
        .user-menu {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 4px;
        }

            .user-menu a {
                color: white;
                text-decoration: none;
                font-weight: bold;
            }

                .user-menu a:hover {
                    text-decoration: underline;
                }

        /* Footer at bottom of page */
        footer {
            background-color: #2c7744;
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
        }

        /* Green tips box */
        .growing-tips {
            background-color: #e8f5e9;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border-left: 5px solid #2c7744;
        }

            .growing-tips h4 {
                color: #2c7744;
                margin-bottom: 0.5rem;
            }

        /* Climate results styles */
        .climate-card {
            background-color: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-top: 1rem;
        }

            .climate-card h4 {
                color: #2c7744;
                margin-bottom: 0.5rem;
            }

        .crop-list, .tips-list {
            list-style-position: inside;
            margin-left: 1rem;
        }

        .error-message {
            color: #e53935;
            background-color: #ffebee;
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
        }

        /* Makes the site look good on phones */
        @media (max-width: 768px) {
            nav ul {
                flex-direction: column;
                align-items: center;
            }

                nav ul li {
                    margin: 0.5rem 0;
                }

            .features {
                grid-template-columns: 1fr;
            }

            .category-cards {
                grid-template-columns: 1fr;
            }

            .crop-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .user-menu {
                position: static;
                text-align: center;
                margin-top: 1rem;
                background-color: transparent;
            }
        }
    </style>
    <link rel="stylesheet" href="/mobile-styles.css">
    <!-- Load the climate API JavaScript file -->
    <script src="climate-api.js"></script>
</head>
<body>
    <header>
        <h1>Urban Farming Solutions</h1>
        <p>Fighting World Hunger Through Sustainable Urban Agriculture</p>
        <div id="user-account" class="user-menu">
            <!-- JavaScript will put login/logout buttons here -->
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="/#home">Home</a></li>
            <li><a href="/#growing">Growing Guides</a></li>
            <li><a href="/#education">Education</a></li>
            <li><a href="/#resources">Resource Sharing</a></li>
            <li><a href="/#architecture.html">Architecture</a></li>
            <li><a href="/#about">About Us</a></li>
            <li><a href="/progress-dashboard.html">Progress</a></li>
        </ul>
    </nav>

    <main>
        <section class="hero">
            <h2>Grow Your Own Food, Combat Hunger</h2>
            <p>Learn how to grow and harvest crops in any climate, share resources with your community, and contribute to a sustainable future.</p>
        </section>

        <section class="features">
            <div class="feature-card">
                <h3>Climate-Specific Growing Guides</h3>
                <p>Our platform provides detailed guides on growing various crops based on your local climate conditions.</p>
            </div>

            <div class="feature-card">
                <h3>Resource Sharing Network</h3>
                <p>Connect with others in your community to share seeds, tools, and containers for urban farming.</p>
            </div>

            <div class="feature-card">
                <h3>Urban Farming Architecture</h3>
                <p>Explore creative designs for maximizing urban spaces for food production.</p>
            </div>
        </section>

        <section id="growing" class="growing-section">
            <h2>Growing Guides</h2>
            <p>Choose a category to explore step-by-step guides for growing various crops in urban environments.</p>

            <!-- Shows the 3 main categories -->
            <div id="category-view">
                <div class="category-cards">
                    <div class="category-card" data-category="vegetables">
                        <div class="category-image">
                            <img src="/images/vegetables-category.jpg" alt="Fresh vegetables" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <div class="category-content">
                            <h3>Vegetables</h3>
                            <p>Grow nutritious vegetables like tomatoes, lettuce, carrots, and more in your urban space.</p>
                        </div>
                    </div>

                    <div class="category-card" data-category="fruits">
                        <div class="category-image">
                            <img src="/images/fruits-category.jpg" alt="Fresh fruits" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <div class="category-content">
                            <h3>Fruits</h3>
                            <p>Learn to cultivate delicious fruits like strawberries, apples, and berries in containers and small spaces.</p>
                        </div>
                    </div>

                    <div class="category-card" data-category="herbs">
                        <div class="category-image">
                            <img src="/images/herbs-category.jpg" alt="Fresh herbs and spices" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <div class="category-content">
                            <h3>Herbs</h3>
                            <p>Start your herb garden with basil, mint, parsley, and other aromatic plants perfect for windowsills.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Shows individual crops after clicking a category -->
            <div id="crop-view" style="display: none;">
                <button class="back-btn" id="back-to-categories">← Back to Categories</button>
                <h3 id="category-title"></h3>
                <div id="crop-grid" class="crop-grid">
                    <!-- JavaScript adds crops here -->
                </div>
            </div>
        </section>

        <section id="education" class="climate-section">
            <h2>Education Website</h2>
            <p>Our comprehensive guides help you understand how to grow food in any climate condition.</p>

            <div id="climate-widget">
                <h3>Weather-Based Growing Recommendations</h3>
                <p>We use real-time weather data from <a href="https://open-meteo.com/" target="_blank">Open-Meteo</a> to provide you with personalized growing recommendations based on your local climate conditions.</p>

                <div id="weather-demo">
                    <div class="form-group">
                        <h4>Enter your location to get started:</h4>
                        <div style="display: flex; margin-bottom: 1rem;">
                            <input type="text" id="location-input" placeholder="Enter city name" style="flex: 1; margin-right: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <button class="btn" id="get-recommendations" style="margin-top: 0;">Get Recommendations</button>
                        </div>
                    </div>

                    <div id="loading-indicator" style="display: none; text-align: center; margin: 1rem 0;">
                        <p>Loading climate data...</p>
                    </div>

                    <div id="error-message" style="display: none; color: #e53935; background-color: #ffebee; padding: 1rem; border-radius: 4px; margin: 1rem 0;"></div>

                    <div id="climate-results" style="display: none;">
                        <div class="location-info" style="background-color: #e8f5e9; padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
                            <h4 id="location-name"></h4>
                            <p id="location-region"></p>
                        </div>

                        <div class="climate-data" style="margin-bottom: 1rem;">
                            <h4>Climate Summary</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 0.5rem;">
                                <div style="flex: 1; min-width: 200px; background-color: white; padding: 1rem; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <p><strong>Climate Type:</strong> <span id="climate-type"></span></p>
                                    <p><strong>Avg Max Temp:</strong> <span id="avg-max-temp"></span>°C</p>
                                    <p><strong>Avg Min Temp:</strong> <span id="avg-min-temp"></span>°C</p>
                                    <p><strong>Total Precipitation:</strong> <span id="total-precipitation"></span> mm</p>
                                </div>
                            </div>
                        </div>

                        <div class="growing-tips">
                            <h4>Growing Tips for Your Climate</h4>
                            <p id="climate-description"></p>
                        </div>

                        <div class="recommendations">
                            <h4>Recommended Crops</h4>

                            <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                                <div class="crop-category" style="flex: 1; min-width: 200px; background-color: white; padding: 1rem; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h5 style="color: #2c7744; margin-bottom: 0.5rem;">Vegetables</h5>
                                    <ul id="vegetable-list" style="list-style-position: inside;"></ul>
                                </div>

                                <div class="crop-category" style="flex: 1; min-width: 200px; background-color: white; padding: 1rem; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h5 style="color: #2c7744; margin-bottom: 0.5rem;">Herbs</h5>
                                    <ul id="herb-list" style="list-style-position: inside;"></ul>
                                </div>

                                <div class="crop-category" style="flex: 1; min-width: 200px; background-color: white; padding: 1rem; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h5 style="color: #2c7744; margin-bottom: 0.5rem;">Fruits</h5>
                                    <ul id="fruit-list" style="list-style-position: inside;"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 2rem;">
                    <h4>Sample Climate-Based Recommendations:</h4>
                    <ul>
                        <li><strong>Hot and Dry Climate:</strong> Drought-resistant vegetables like tomatoes, peppers, and herbs</li>
                        <li><strong>Cool and Wet Climate:</strong> Leafy greens, root vegetables, and berries</li>
                        <li><strong>Tropical Climate:</strong> Fruits like papaya and banana, along with various herbs and spices</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="resources" class="resource-section">
            <h2>Resource Sharing Application</h2>
            <p>Our platform connects urban farmers to share resources, reducing waste and costs.</p>

            <div>
                <h3>Available Resources</h3>
                <ul>
                    <li>Seeds and seedlings</li>
                    <li>Tools and equipment</li>
                    <li>Containers and planters</li>
                    <li>Compost and soil</li>
                </ul>
            </div>

            <div>
                <h3>How It Works</h3>
                <ol>
                    <li>Create an account</li>
                    <li>List resources you're willing to share</li>
                    <li>Browse resources offered by community members</li>
                    <li>Connect and arrange exchanges</li>
                </ol>
            </div>

            <a href="/resource-sharing.html" class="btn">Try the Resource Sharing App</a>
        </section>

        <section id="architecture">
            <h2>Urban Farming Architecture</h2>
            <p>Discover innovative ways to maximize limited urban spaces for growing food.</p>

            <div class="features">
                <div class="feature-card">
                    <h3>Vertical Growing Systems</h3>
                    <p>Learn how to build space-efficient vertical gardens using recycled materials.</p>
                </div>

                <div class="feature-card">
                    <h3>Rooftop Gardens</h3>
                    <p>Transform unused roof space into productive growing areas for vegetables and herbs.</p>
                </div>

                <div class="feature-card">
                    <h3>Window Farming</h3>
                    <p>Simple solutions for growing food on windowsills and balconies in apartments.</p>
                </div>
            </div>

            <a href="/architecture.html" class="btn">View Architecture Plans</a>
        </section>

        <section id="about" style="margin-top: 3rem; text-align: center;">
            <h2>About Urban Farming Solutions</h2>
            <p>We're dedicated to fighting world hunger by empowering urban communities to grow their own food. Our platform provides the knowledge, tools, and community support needed to transform any space into a productive garden.</p>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Urban Farming Solutions. All rights reserved.</p>
        <p>Fighting world hunger through sustainable urban agriculture.</p>
    </footer>

    <script>
        // This stores all the information about different crops
        const cropData = {
            vegetables: [
                { name: 'Tomatoes', description: 'Perfect for containers, high yield', guide: '/tomato-guide.html', image: '/images/tomatoes.jpg' },
                { name: 'Lettuce', description: 'Quick growing, space-efficient', guide: '/lettuce-guide.html', image: '/images/lettuce.jpg' },
                { name: 'Potato', description: 'Grow in bags or deep containers', guide: '/potato-guide.html', image: '/images/potato.jpg' },
                { name: 'Carrot', description: 'Great for deep containers', guide: '/carrot-guide.html', image: '/images/carrot.jpg' },
            ],
            fruits: [
                { name: 'Apples', description: 'Dwarf varieties for small spaces', guide: '/apple-guide.html', image: '/images/apple.jpg' },
                { name: 'Strawberries', description: 'Perfect for hanging baskets', guide: '/strawberries-guide.html', image: '/images/strawberries.jpg' },
                { name: 'Raspberries', description: 'Productive canes in containers', guide: '/raspberry-guide.html', image: '/images/raspberries.jpg' },
                { name: 'Blueberries', description: 'Container-friendly, antioxidant-rich', guide: '/blueberry-guide.html', image: '/images/blueberries.jpg' }
            ],
            herbs: [
                { name: 'Basil', description: 'Easy to grow, culinary favorite', guide: '/basil-guide.html', image: '/images/basil.jpg' },
                { name: 'Mint', description: 'Vigorous grower, refreshing', guide: '/mint-guide.html', image: '/images/mint.jpg' },
                { name: 'Coriander', description: 'Fast growing, flavorful leaves', guide: '/coriander-guide.html', image: '/images/coriander.jpg' },
                { name: 'Thyme', description: 'Low-growing, aromatic', guide: '/thyme-guide.html', image: '/images/thyme.jpg' },

            ]
        };

        // This runs when the page loads to check if user is logged in
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                // Ask the server if user is logged in
                const response = await fetch('/check-auth');
                const data = await response.json();

                const userAccountDiv = document.getElementById('user-account');

                // Show different buttons based on login status
                if (data.isAuthenticated) {
                    userAccountDiv.innerHTML = `
                                    <span>Welcome, ${data.username}! </span>
                                    <a href="/profile.html">My Profile</a> |
                                    <a href="/logout">Logout</a>
                                `;
                } else {
                    userAccountDiv.innerHTML = `
                                    <a href="/login.html">Login</a> |
                                    <a href="/register.html">Register</a>
                                `;
                }
            } catch (error) {
                console.error('Error checking authentication:', error);
            }
        });

        // This runs after page loads to set up all the buttons and features
        document.addEventListener('DOMContentLoaded', function () {
            // Make category cards clickable
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', function () {
                    const category = this.getAttribute('data-category');
                    showCrops(category);
                });
            });

            // Make back button work
            document.getElementById('back-to-categories').addEventListener('click', function () {
                showCategories();
            });

            // Modified climate functionality to work with climate-api.js
            const getClimateButton = document.getElementById('get-recommendations');
            const locationInput = document.getElementById('location-input');
            const loadingIndicator = document.getElementById('loading-indicator');
            const errorMessage = document.getElementById('error-message');
            const climateResults = document.getElementById('climate-results');

            // Elements where we'll show the weather results
            const locationName = document.getElementById('location-name');
            const locationRegion = document.getElementById('location-region');
            const climateType = document.getElementById('climate-type');
            const avgMaxTemp = document.getElementById('avg-max-temp');
            const avgMinTemp = document.getElementById('avg-min-temp');
            const totalPrecipitation = document.getElementById('total-precipitation');
            const climateDescription = document.getElementById('climate-description');
            const vegetableList = document.getElementById('vegetable-list');
            const herbList = document.getElementById('herb-list');
            const fruitList = document.getElementById('fruit-list');

            // Override the getClimateRecommendations function to work with the existing UI
            window.getClimateRecommendations = async function () {
                const location = locationInput.value.trim();

                // Make sure they typed something
                if (!location) {
                    showError('Please enter a location');
                    return;
                }

                // Show loading message
                loadingIndicator.style.display = 'block';
                errorMessage.style.display = 'none';
                climateResults.style.display = 'none';

                try {
                    // Enhanced city finding with better error handling
                    const normalizedInput = location.toLowerCase();
                    let locationData;
                    let cityName;
                    let possibleMatches = [];

                    // First check for exact match
                    if (cityCoordinates[normalizedInput]) {
                        locationData = cityCoordinates[normalizedInput];
                        cityName = normalizedInput.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                    } else {
                        // Find all partial matches
                        for (const city in cityCoordinates) {
                            if (city.includes(normalizedInput)) {
                                possibleMatches.push({
                                    name: city,
                                    coordinates: cityCoordinates[city],
                                    matchScore: city.startsWith(normalizedInput) ? 2 : 1
                                });
                            }
                        }

                        // Sort by match score (prioritize cities that start with the input)
                        possibleMatches.sort((a, b) => b.matchScore - a.matchScore);

                        if (possibleMatches.length === 0) {
                            throw new Error(`City "${location}" not found. Please try entering a major city name like London, Paris, New York, Tokyo, etc.`);
                        } else if (possibleMatches.length === 1) {
                            // Only one match found
                            locationData = possibleMatches[0].coordinates;
                            cityName = possibleMatches[0].name.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                        } else {
                            // Multiple matches - show options to user
                            const cityList = possibleMatches.slice(0, 5).map(m =>
                                m.name.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')
                            ).join(', ');
                            throw new Error(`Multiple cities found matching "${location}". Did you mean: ${cityList}? Please be more specific.`);
                        }
                    }

                    // Get the weather for that location
                    const weatherData = await fetchWeatherData(locationData.latitude, locationData.longitude);

                    // Get crop recommendations based on weather
                    const recommendations = getCropRecommendations(weatherData);

                    // Calculate averages for display
                    const maxTemps = weatherData.daily.temperature_2m_max;
                    const minTemps = weatherData.daily.temperature_2m_min;
                    const precipitation = weatherData.daily.precipitation_sum;

                    const avgMaxTempVal = maxTemps.reduce((sum, temp) => sum + temp, 0) / maxTemps.length;
                    const avgMinTempVal = minTemps.reduce((sum, temp) => sum + temp, 0) / minTemps.length;
                    const totalPrecipitationVal = precipitation.reduce((sum, precip) => sum + precip, 0);

                    // Hide loading message
                    loadingIndicator.style.display = 'none';

                    // Display the data in the existing UI format
                    locationName.textContent = cityName;
                    locationRegion.textContent = ''; // Could add country info if available

                    climateType.textContent = recommendations.climate;
                    avgMaxTemp.textContent = avgMaxTempVal.toFixed(1);
                    avgMinTemp.textContent = avgMinTempVal.toFixed(1);
                    totalPrecipitation.textContent = totalPrecipitationVal.toFixed(1);

                    climateDescription.textContent = recommendations.description;

                    // Clear old lists
                    vegetableList.innerHTML = '';
                    herbList.innerHTML = '';
                    fruitList.innerHTML = '';

                    // Define crop categories with 5 climate-appropriate selections each
                    const cropDatabase = {
                        vegetables: {
                            'hot-wet': ['Sweet Potatoes', 'Okra', 'Eggplant', 'Amaranth', 'Taro'],
                            'hot-dry': ['Tomatoes', 'Peppers', 'Eggplant', 'Armenian Cucumber', 'Swiss Chard'],
                            'warm-wet': ['Tomatoes', 'Squash', 'Cucumbers', 'Beans', 'Corn'],
                            'warm-dry': ['Tomatoes', 'Peppers', 'Zucchini', 'Eggplant', 'Beans'],
                            'cool-wet': ['Lettuce', 'Spinach', 'Kale', 'Arugula', 'Peas'],
                            'cool-dry': ['Lettuce', 'Carrots', 'Beets', 'Onions', 'Cabbage']
                        },
                        herbs: {
                            'hot-wet': ['Basil', 'Mint', 'Lemongrass', 'Ginger', 'Turmeric'],
                            'hot-dry': ['Rosemary', 'Thyme', 'Sage', 'Lavender', 'Oregano'],
                            'warm-wet': ['Basil', 'Mint', 'Cilantro', 'Parsley', 'Chives'],
                            'warm-dry': ['Rosemary', 'Thyme', 'Oregano', 'Marjoram', 'Savory'],
                            'cool-wet': ['Parsley', 'Chives', 'Dill', 'Fennel', 'Tarragon'],
                            'cool-dry': ['Parsley', 'Sage', 'Thyme', 'Chives', 'Rosemary']
                        },
                        fruits: {
                            'hot-wet': ['Passion Fruit', 'Papaya', 'Dragon Fruit', 'Mangoes', 'Bananas'],
                            'hot-dry': ['Figs', 'Pomegranates', 'Dates', 'Grapes', 'Citrus'],
                            'warm-wet': ['Strawberries', 'Blackberries', 'Raspberries', 'Blueberries', 'Kiwi'],
                            'warm-dry': ['Grapes', 'Strawberries', 'Melons', 'Figs', 'Apricots'],
                            'cool-wet': ['Blueberries', 'Raspberries', 'Currants', 'Gooseberries', 'Elderberries'],
                            'cool-dry': ['Apples', 'Pears', 'Cherries', 'Plums', 'Apricots']
                        }
                    };

                    // Determine climate type
                    const avgTemp = (avgMaxTempVal + avgMinTempVal) / 2;
                    let climateTypeKey = "";

                    if (avgTemp > 25) {
                        climateTypeKey = totalPrecipitationVal > 20 ? "hot-wet" : "hot-dry";
                    } else if (avgTemp > 15) {
                        climateTypeKey = totalPrecipitationVal > 20 ? "warm-wet" : "warm-dry";
                    } else {
                        climateTypeKey = totalPrecipitationVal > 20 ? "cool-wet" : "cool-dry";
                    }

                    // Get 5 recommendations for each category
                    const vegRecommendations = cropDatabase.vegetables[climateTypeKey] || ['Lettuce', 'Tomatoes', 'Carrots', 'Spinach', 'Radishes'];
                    const herbRecommendations = cropDatabase.herbs[climateTypeKey] || ['Basil', 'Parsley', 'Mint', 'Cilantro', 'Chives'];
                    const fruitRecommendations = cropDatabase.fruits[climateTypeKey] || ['Strawberries', 'Blueberries', 'Apples', 'Raspberries', 'Grapes'];

                    // Add vegetables
                    vegRecommendations.forEach(veg => {
                        const li = document.createElement('li');
                        li.textContent = veg;
                        vegetableList.appendChild(li);
                    });

                    // Add herbs
                    herbRecommendations.forEach(herb => {
                        const li = document.createElement('li');
                        li.textContent = herb;
                        herbList.appendChild(li);
                    });

                    // Add fruits
                    fruitRecommendations.forEach(fruit => {
                        const li = document.createElement('li');
                        li.textContent = fruit;
                        fruitList.appendChild(li);
                    });

                    // Show all the results
                    climateResults.style.display = 'block';

                } catch (error) {
                    loadingIndicator.style.display = 'none';
                    showError(error.message || 'Error connecting to the climate service');
                }
            };

            // Shows error messages in a red box
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                climateResults.style.display = 'none';
            }

            // Makes "hot-dry" look like "Hot Dry"
            function formatClimateType(type) {
                return type.split('-')
                    .map(word => capitalizeFirstLetter(word))
                    .join(' ');
            }

            // Makes "apple" look like "Apple"
            function capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }
        });

        // Shows all the crops when you click a category
        function showCrops(category) {
            // Hide categories, show crops
            document.getElementById('category-view').style.display = 'none';
            document.getElementById('crop-view').style.display = 'block';

            // Set the title
            const titles = {
                vegetables: 'Vegetables',
                fruits: 'Fruits',
                herbs: 'Herbs'
            };
            document.getElementById('category-title').textContent = titles[category];

            // Clear old crops and add new ones
            const cropGrid = document.getElementById('crop-grid');
            cropGrid.innerHTML = '';
            cropGrid.style.display = 'grid';

            // Create a card for each crop
            cropData[category].forEach(crop => {
                const cropItem = document.createElement('div');
                cropItem.className = 'crop-item';

                // Add image if we have one, otherwise show placeholder
                if (crop.image) {
                    cropItem.innerHTML = `
                                    <div class="crop-image">
                                        <img src="${crop.image}" alt="${crop.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                    </div>
                                    <h4>${crop.name}</h4>
                                    <p>${crop.description}</p>
                                `;
                } else {
                    cropItem.innerHTML = `
                                    <div class="crop-image">
                                        <span class="image-placeholder" style="font-size: 12px; color: #999;">[${crop.name}]</span>
                                    </div>
                                    <h4>${crop.name}</h4>
                                    <p>${crop.description}</p>
                                `;
                }

                // Open guide when crop is clicked
                cropItem.addEventListener('click', function () {
                    window.open(crop.guide, '_blank');
                });

                cropGrid.appendChild(cropItem);
            });
        }

        // Goes back to show all categories
        function showCategories() {
            document.getElementById('crop-view').style.display = 'none';
            document.getElementById('category-view').style.display = 'block';
        }
    </script>
</body>
</html>
